Loading file 30 for label HToBB
Loading file 31 for label HToBB
Loading file 32 for label HToBB
Loading file 33 for label HToBB
Loading file 34 for label HToBB
Loading file 35 for label HToBB
Loading file 36 for label HToBB
Loading file 37 for label HToBB
Loading file 38 for label HToBB
Loading file 39 for label HToBB
Loading file 40 for label HToBB
Loading file 41 for label HToBB
Loading file 42 for label HToBB
Loading file 43 for label HToBB
Loading file 44 for label HToBB
Loading file 45 for label HToBB
Loading file 46 for label HToBB
Loading file 47 for label HToBB
Loading file 48 for label HToBB
Loading file 49 for label HToBB
Loading file 50 for label HToBB
Loading file 51 for label HToBB
Loading file 52 for label HToBB
Loading file 53 for label HToBB
Loading file 54 for label HToBB
Loading file 55 for label HToBB
Loading file 56 for label HToBB
Loading file 57 for label HToBB
Loading file 58 for label HToBB
Loading file 59 for label HToBB
/pscratch/sd/h/haoming/Projects/hep_models/scripts/new_train.py:50: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
üîÅ Resuming from: checkpoints/checkpoints_vqvae_normformer_flash/vqvae_epoch_50.pth
/pscratch/sd/h/haoming/Projects/hep_models/scripts/new_train.py:74: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
üìà Epoch [51/60] - Total: 0.0061 | Recon: 0.0018 | VQ: 0.0043
üìà Epoch [52/60] - Total: 0.0144 | Recon: 0.0035 | VQ: 0.0109
üìà Epoch [53/60] - Total: 0.0048 | Recon: 0.0016 | VQ: 0.0032
üìà Epoch [54/60] - Total: 0.0045 | Recon: 0.0015 | VQ: 0.0030
üìà Epoch [55/60] - Total: 0.0042 | Recon: 0.0015 | VQ: 0.0027
üìà Epoch [56/60] - Total: 0.0041 | Recon: 0.0014 | VQ: 0.0027
üìà Epoch [57/60] - Total: 0.0038 | Recon: 0.0014 | VQ: 0.0025
üìà Epoch [58/60] - Total: 0.0036 | Recon: 0.0013 | VQ: 0.0023
üìà Epoch [59/60] - Total: 0.0047 | Recon: 0.0015 | VQ: 0.0033
üìà Epoch [60/60] - Total: 0.0035 | Recon: 0.0013 | VQ: 0.0022
üíæ Saved checkpoint: checkpoints/checkpoints_vqvae_normformer_flash/vqvae_epoch_60.pth
Loading file 15 for label HToBB
Loading file 16 for label HToBB
Loading file 17 for label HToBB
üìä Final Evaluation Stats
Original mean: tensor([6.1900e+02, 2.1608e-03, 2.2010e-04, 1.2072e+02], device='cuda:0')
Reconstructed mean: tensor([6.2406e+02, 7.1339e-03, 1.5658e-02, 1.2168e+02], device='cuda:0')
Original std: tensor([107.8338,   0.8802,   1.8135,  23.5459], device='cuda:0')
Reconstructed std: tensor([107.7291,   0.8759,   1.8144,  24.2903], device='cuda:0')
‚úÖ Saved plot to jet_recon_overlay_normformer_particles.png
Traceback (most recent call last):
  File "/pscratch/sd/h/haoming/Projects/hep_models/scripts/new_train.py", line 159, in <module>
    vqvae.plot_model(model, x_particles, saveas="vqvae_model_normformer_particles.png")
  File "/pscratch/sd/h/haoming/Projects/hep_models/models/NormFormer_Flash.py", line 310, in plot_model
    ax.hist(idx, bins=bins)
  File "/global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages/matplotlib/__init__.py", line 1465, in inner
    return func(ax, *map(sanitize_sequence, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages/matplotlib/axes/_axes.py", line 6772, in hist
    x = cbook._reshape_2D(x, 'x')
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages/matplotlib/cbook.py", line 1412, in _reshape_2D
    raise ValueError(f'{name} must have 2 or fewer dimensions')
ValueError: x must have 2 or fewer dimensions
